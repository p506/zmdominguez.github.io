---
layout: post
title: Using resource IDs in data binding layouts
date: '2016-07-19T14:11:00.004+10:00'
author: Zarah Dominguez
tags:
- data binding
- resources
- android
modified_time: '2016-07-19T15:00:34.823+10:00'
thumbnail: https://1.bp.blogspot.com/-K7hsk5AlZOo/V42jxWTtoqI/AAAAAAAAeWI/x4BEoqoeVSscOidyZd9NlwHobVhGlHcxQCLcB/s72-c/device-2016-07-17-225953.png
blogger_id: tag:blogger.com,1999:blog-8588450866181483028.post-316193729330520012
blogger_orig_url: http://www.zdominguez.com/2016/07/using-resource-ids-in-data-binding.html
---

I have been playing with data binding more and more over the last couple of weeks. This week, it's all about creating a dialog with stuff dictated by a value from an enum.<br /><br />Each value in <a href="https://github.com/zmdominguez/sdk_sandbox/blob/master/app/src/main/java/com/zdominguez/sdksandbox/models/AdventureTimeCharacters.java" target="_blank">this enum</a> has the following properties:<br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">@IdRes int textView</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">@StringRes int quote</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">@StringRes int name</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">@ColorRes int colour</span><br /><br />I have added a new button in my <a href="https://github.com/zmdominguez/sdk_sandbox" target="_blank">Sandbox app</a> to choose one value from the enum and display the properties in an alert dialog via data binding. Ambitious, I know!<br /><br />The relevant Java part is mainly just creating and showing the dialog:<br /><pre class="brush:java">@OnClick(R.id.data_binding_alert)<br />public void onSendDataBoundAlert() {<br />   AlertDialog.Builder builder = new AlertDialog.Builder(MainActivity.this, R.style.MaterialAlertDialog);<br />   builder.setPositiveButton(android.R.string.ok, null)<br />           .setNegativeButton("Not now", null);<br />   View view = LayoutInflater.from(MainActivity.this).inflate(R.layout.dialog_data_binding_demo, null);<br />   DialogDataBindingDemoBinding binding = DataBindingUtil.bind(view);<br />   binding.setCharacter(getRandomCharacter());<br />   builder.setView(view);<br /><br />   builder.create().show();<br />}<br /></pre><br />The tricky part is telling data binding how to use our resource IDs. Say I want the colour to be set as a background for a <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">TextView</span>, and the name to be displayed:<br /><pre class="brush:xml; highlight:[10,11]">&lt;TextView<br />     android:id="@+id/name"<br />     android:layout_width="match_parent"<br />     android:layout_height="wrap_content"<br />     android:minHeight="64dp"<br />     android:textSize="24sp"<br />     android:textStyle="bold"<br />     android:gravity="center_vertical"<br />     android:paddingLeft="16dp"<br />     android:background="@{character.colour}"<br />     android:text="@{character.name}"/&gt;<br /></pre><br />Running the sample though, you'll see that the colour is not set and a dark grey-ish lilac-ish colour is used instead:<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-K7hsk5AlZOo/V42jxWTtoqI/AAAAAAAAeWI/x4BEoqoeVSscOidyZd9NlwHobVhGlHcxQCLcB/s1600/device-2016-07-17-225953.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="https://1.bp.blogspot.com/-K7hsk5AlZOo/V42jxWTtoqI/AAAAAAAAeWI/x4BEoqoeVSscOidyZd9NlwHobVhGlHcxQCLcB/s320/device-2016-07-17-225953.png" width="180" /></a></div><span id="goog_614749195"></span><span id="goog_614749196"></span><br /><br />Unacceptable indeed!<br /><br />So how do we make the Earl of Lemongrab happy? There are two ways of solving this problem.<br /><br /><b>A. Use a BindingAdapter</b><br /><br />A <a href="https://developer.android.com/reference/android/databinding/BindingAdapter.html" target="_blank"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">BindingAdapter</span></a> lets you manipulate and do a bit more involved logic on your data before applying it to the <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">View</span>. To use a <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">BindingAdapter</span>, first create a static method in your code that is bound to either a standard Android attribute or a custom one.<br /><br />I create a custom attribute here called <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">characterBackground</span>:<br /><pre class="brush:java">@BindingAdapter({"characterBackground"})<br />public static void characterBackground(TextView textView, AdventureTimeCharacters character) {<br />     textView.setBackgroundColor(ContextCompat.getColor(textView.getContext(), character.getColour()));<br />}<br /></pre><br />You can then use this <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">BindingAdapter</span> in the <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">TextView</span>:<br /><pre class="brush:xml" style="text-align: center;">app:characterBackground="@{character}"<br /></pre>Do not forget to add the app namespace! Android Studio can add this for you. Just type in <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">appNs</span> and it will autocomplete. <br /><br />This solution works, but is a bit too involved. And you said data binding is easy!!!<br /><br />Well it kinda is, because, it turns out that we can:<br /><b>B. Set the value in XML</b><br /><br />But it didn't work! Well it turns out the problem is because we are passing a resource ID into an attribute that expects a resolved color value. So the only thing we need to do is to move all that code in our <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">BindingAdapter</span> into XML.<br /><br />First add the import:<br /><pre class="brush:xml">&lt;data&gt;<br />    . . .<br />    &lt;import type="android.support.v4.content.ContextCompat" /&gt;<br />&lt;/data&gt;<br /></pre><br />And then use it: <br /><pre class="brush:xml; highlight:[10,11]">&lt;TextView<br />     android:id="@+id/name"<br />     android:layout_width="match_parent"<br />     android:layout_height="wrap_content"<br />     android:minHeight="64dp"<br />     android:textSize="24sp"<br />     android:textStyle="bold"<br />     android:gravity="center_vertical"<br />     android:paddingLeft="16dp"<br />     android:background="@{ContextCompat.getColor(context, character.colour)}"<br />     android:text="@{character.name}"/&gt;&nbsp;</pre><br />Very convenient! And it works! Note that you do not have to import anything to use&nbsp;<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">context</span>, there is some data binding magic going on that automatically injects it for you if you call it. Think of it as The Beckoning of the Context.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-00MWkXjIQcA/V42oBcznX-I/AAAAAAAAeWY/WmXbW-AmRdsEwr_v-g9v0FwuZ5LgHnmFwCLcB/s1600/device-2016-07-19-140855.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="https://1.bp.blogspot.com/-00MWkXjIQcA/V42oBcznX-I/AAAAAAAAeWY/WmXbW-AmRdsEwr_v-g9v0FwuZ5LgHnmFwCLcB/s320/device-2016-07-19-140855.png" width="180" /></a></div><br />The Earl is now happy.<br /><br />PS: If you need to set a drawable from a resource ID as an <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">ImageView</span> src, I found that you would also need to do this trick, aka:<br /><pre class="brush:xml">android:src="@{ContextCompat.getDrawable(context, character.icon)}"</pre><br /><br />