---
layout: post
title: Stylish Dynamic Layouts
date: '2016-08-04T23:11:00.001+10:00'
author: Zarah Dominguez
tags:
- style
- android
- layout
modified_time: '2016-08-05T20:29:08.158+10:00'
thumbnail: https://4.bp.blogspot.com/-c7pj__u-D6A/V6M0bEj6sHI/AAAAAAAAgEk/pCxCW6F3plIc3DM6irhmB48SR8S9AggkACLcB/s72-c/device-2016-08-04-183547.png
blogger_id: tag:blogger.com,1999:blog-8588450866181483028.post-5129456296841062010
blogger_orig_url: http://www.zdominguez.com/2016/08/stylish-dynamic-layouts.html
---

One of the things we are taught in Android is that we should gracefully handle different layouts based on screen sizes. With more and more things being not just screen size-specific but also OS version-specific, this is one thing I think a lot more devs need to pay attention to. Today was my turn to do just that.<br /><br />I wanted to create a dialog with an image that resizes itself while maintaining aspect ratio but being constrained by the container. Okay.<br /><br />So I went about creating my <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">ImageView</span>:<br /><pre class="brush:xml">&lt;ImageView<br />android:id="@+id/permission_image"<br />android:layout_width="match_parent"<br />android:layout_height="wrap_content"<br />android:minHeight="200dp"<br />android:adjustViewBounds="true"<br />android:scaleType="centerCrop"<br />android:src="@{ContextCompat.getDrawable(context, permission.descriptionDrawable)}"/&gt;<br /></pre><br />Loaded up the layout and it looks satisfactory:<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-c7pj__u-D6A/V6M0bEj6sHI/AAAAAAAAgEk/pCxCW6F3plIc3DM6irhmB48SR8S9AggkACLcB/s1600/device-2016-08-04-183547.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="https://4.bp.blogspot.com/-c7pj__u-D6A/V6M0bEj6sHI/AAAAAAAAgEk/pCxCW6F3plIc3DM6irhmB48SR8S9AggkACLcB/s320/device-2016-08-04-183547.png" width="180" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div>But then, I tried rotating and what the hell!<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-nRzdzcLOWy4/V6M1wCbomdI/AAAAAAAAgE4/0Zp6frPmFqQyDhWuSaB4ffMUr16yPFKwgCLcB/s1600/device-2016-08-04-183648.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="180" src="https://4.bp.blogspot.com/-nRzdzcLOWy4/V6M1wCbomdI/AAAAAAAAgE4/0Zp6frPmFqQyDhWuSaB4ffMUr16yPFKwgCLcB/s320/device-2016-08-04-183648.png" width="320" /></a></div><div class="" style="clear: both; text-align: left;"><br /></div>The image does not fit, you cannot see "NOT NOW". It doesn't work. Then I tried it on a tablet: <br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-3z7pgKCFByw/V6NEPmBZR5I/AAAAAAAAgFo/BDAvKXd1cGYvjic5z55bEQruguSDwypegCLcB/s1600/device-2016-08-04-120325.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="https://3.bp.blogspot.com/-3z7pgKCFByw/V6NEPmBZR5I/AAAAAAAAgFo/BDAvKXd1cGYvjic5z55bEQruguSDwypegCLcB/s320/device-2016-08-04-120325.png" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div>OMG how could it possibly get worse. There is so much space and it's not filling it up properly! I am pretty sure the root layout has <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">layout_height="wrap_content"</span>. Weird.<br /><br />After some furious Googling, I found out that I have to set the <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">LayoutParams</span> on the dialog after it has been shown. Why do I have to do that? I said wrap it and you refuse and now you want me to do it myself? Why?<br /><br />I gave in and did the thing that StackOverflow tells me to. But it didn't work. It still looked the same. I tried moving stuff around; calling <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">setLayout</span> instead of <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">setAttributes</span>. It still looked the same. :sad_panda:<br /><br />And so the time has come to look for another approach. A couple of things need to happen:<br />a. We shouldn't make the user scroll just to click the buttons on a landscape phone<br />b. Make the image take up more space on tablets<br /><br />To make (a) happen, we either: create a new layout for this orientation or just set the image to be invisible. The second option is more appealing for me. There really is not much difference in the two orientations aside from the image after all. We can set the visibility of the image at runtime, but then maybe we can afford to show the image if there is enough space for it.<br /><br />This means that to make (b) happen, maybe we need to tweak our layout a little. And this is where the beauty of Android's <a href="https://developer.android.com/guide/topics/resources/providing-resources.html" target="_blank">alternative resources</a> come in. To be as less repetitive as possible, I chose to harness styles too, since I only need to override one attribute -- the visibility.<br /><br />First I created a style in the default <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">/res/values</span> folder that I would apply to the image:<br /><pre class="brush:xml">&lt;style name="DescriptionImage"&gt;<br />   &lt;item name="android:visibility"&gt;gone&lt;/item&gt;<br />&lt;/style&gt;<br /></pre><br />Now it's time to make the variations. We want to hide the image if we are in landscape, so into <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">/res/values-land</span> this style goes:<br /><pre class="brush:xml">&lt;style name="DescriptionImage"&gt;<br />   &lt;item name="android:visibility"&gt;gone&lt;/item&gt;<br />&lt;/style&gt;</pre><br />But we want to show it if there is enough space, so into <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">/res/values-h500dp</span> this style goes:<br /><pre class="brush:xml">&lt;style name="DescriptionImage"&gt;<br />   &lt;item name="android:visibility"&gt;visible&lt;/item&gt;<br />&lt;/style&gt;</pre><br />And now it's just a matter of applying this style to our image (and I found out that setting <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: small;">maxHeight</span> works a bit better):<br /><pre class="brush:xml; highlight: [8]">&lt;ImageView<br />android:id="@+id/permission_image"<br />android:layout_width="match_parent"<br />android:layout_height="wrap_content"<br />android:maxHeight="200dp"<br />android:adjustViewBounds="true"<br />android:scaleType="centerCrop"<br />style="@style/DescriptionImage"<br />android:src="@{ContextCompat.getDrawable(context, permission.descriptionDrawable)}"/&gt;</pre><br />I applied this technique to another dialog and here's the end result on a phone:<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-Mf7fJKkWkQ0/V6RqDGUOTEI/AAAAAAAAgMs/ra_dEUGWQhk7DLs1n02k1nE8vhGyDTNHwCLcB/s1600/dialog_resize_style.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="https://4.bp.blogspot.com/-Mf7fJKkWkQ0/V6RqDGUOTEI/AAAAAAAAgMs/ra_dEUGWQhk7DLs1n02k1nE8vhGyDTNHwCLcB/s320/dialog_resize_style.gif" width="180" /></a></div><br /><br />Yay! 